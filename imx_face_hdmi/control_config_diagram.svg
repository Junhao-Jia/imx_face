<svg width="1000" height="600" xmlns="http://www.w3.org/2000/svg">
  <!-- 背景 -->
  <rect width="1000" height="600" fill="#ffffff"/>
  
  <!-- 箭头标记定义 -->
  <defs>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#000000"/>
    </marker>
  </defs>
  
  <!-- 标题 -->
  <text x="500" y="50" font-family="Arial" font-size="24" font-weight="bold" text-anchor="middle">IMX ISP 系统控制与配置架构图</text>
  
  <!-- TD开发环境 -->
  <rect x="100" y="100" width="200" height="400" rx="10" fill="#e6f3ff" stroke="#000000" stroke-width="2"/>
  <text x="200" y="130" font-family="Arial" font-size="16" font-weight="bold" text-anchor="middle">安路TD开发环境</text>
  
  <!-- TD环境子模块 -->
  <rect x="120" y="160" width="160" height="60" rx="5" fill="#b3d9ff" stroke="#000000" stroke-width="1"/>
  <text x="200" y="185" font-family="Arial" font-size="14" text-anchor="middle">项目管理与代码编辑</text>
  <text x="200" y="205" font-family="Arial" font-size="12" text-anchor="middle">RTL代码管理、参数配置</text>
  
  <rect x="120" y="240" width="160" height="60" rx="5" fill="#b3d9ff" stroke="#000000" stroke-width="1"/>
  <text x="200" y="265" font-family="Arial" font-size="14" text-anchor="middle">IP核配置</text>
  <text x="200" y="285" font-family="Arial" font-size="12" text-anchor="middle">PLL/ChipWatcher/Soft_FIFO</text>
  
  <rect x="120" y="320" width="160" height="60" rx="5" fill="#b3d9ff" stroke="#000000" stroke-width="1"/>
  <text x="200" y="345" font-family="Arial" font-size="14" text-anchor="middle">时序约束管理</text>
  <text x="200" y="365" font-family="Arial" font-size="12" text-anchor="middle">SDC约束编写、时序验证</text>
  
  <rect x="120" y="400" width="160" height="60" rx="5" fill="#b3d9ff" stroke="#000000" stroke-width="1"/>
  <text x="200" y="425" font-family="Arial" font-size="14" text-anchor="middle">综合与布局布线</text>
  <text x="200" y="445" font-family="Arial" font-size="12" text-anchor="middle">时序优化、位流生成</text>
  
  <!-- 配置数据流 -->
  <rect x="350" y="100" width="200" height="400" rx="10" fill="#e6fff2" stroke="#000000" stroke-width="2"/>
  <text x="450" y="130" font-family="Arial" font-size="16" font-weight="bold" text-anchor="middle">配置数据流</text>
  
  <!-- 配置数据流子模块 -->
  <rect x="370" y="160" width="160" height="50" rx="5" fill="#ccffdd" stroke="#000000" stroke-width="1"/>
  <text x="450" y="185" font-family="Arial" font-size="14" text-anchor="middle">参数配置文件</text>
  <text x="450" y="205" font-family="Arial" font-size="12" text-anchor="middle">.prj/.tcl配置文件</text>
  
  <rect x="370" y="230" width="160" height="50" rx="5" fill="#ccffdd" stroke="#000000" stroke-width="1"/>
  <text x="450" y="255" font-family="Arial" font-size="14" text-anchor="middle">JTAG配置接口</text>
  <text x="450" y="275" font-family="Arial" font-size="12" text-anchor="middle">实时配置与调试</text>
  
  <rect x="370" y="300" width="160" height="50" rx="5" fill="#ccffdd" stroke="#000000" stroke-width="1"/>
  <text x="450" y="325" font-family="Arial" font-size="14" text-anchor="middle">位流文件(.bit)</text>
  <text x="450" y="345" font-family="Arial" font-size="12" text-anchor="middle">FPGA程序烧录</text>
  
  <rect x="370" y="370" width="160" height="50" rx="5" fill="#ccffdd" stroke="#000000" stroke-width="1"/>
  <text x="450" y="395" font-family="Arial" font-size="14" text-anchor="middle">配置验证</text>
  <text x="450" y="415" font-family="Arial" font-size="12" text-anchor="middle">功能与时序检查</text>
  
  <!-- FPGA内部配置模块 -->
  <rect x="600" y="100" width="280" height="400" rx="10" fill="#ffe6e6" stroke="#000000" stroke-width="2"/>
  <text x="740" y="130" font-family="Arial" font-size="16" font-weight="bold" text-anchor="middle">FPGA内部配置模块</text>
  
  <!-- ISP参数寄存器 -->
  <rect x="620" y="160" width="240" height="40" rx="5" fill="#ffcccc" stroke="#000000" stroke-width="1"/>
  <text x="740" y="185" font-family="Arial" font-size="14" text-anchor="middle">ISP参数寄存器</text>
  
  <!-- 寄存器子组 -->
  <rect x="640" y="210" width="100" height="40" rx="5" fill="#ffdddd" stroke="#000000" stroke-width="1"/>
  <text x="690" y="235" font-family="Arial" font-size="12" text-anchor="middle">亮度调整寄存器</text>
  
  <rect x="780" y="210" width="100" height="40" rx="5" fill="#ffdddd" stroke="#000000" stroke-width="1"/>
  <text x="830" y="235" font-family="Arial" font-size="12" text-anchor="middle">皮肤检测阈值</text>
  
  <!-- 系统控制模块 -->
  <rect x="620" y="270" width="240" height="40" rx="5" fill="#ffcccc" stroke="#000000" stroke-width="1"/>
  <text x="740" y="295" font-family="Arial" font-size="14" text-anchor="middle">系统控制模块</text>
  
  <!-- ChipWatcher调试模块 -->
  <rect x="620" y="330" width="240" height="40" rx="5" fill="#ffcccc" stroke="#000000" stroke-width="1"/>
  <text x="740" y="355" font-family="Arial" font-size="14" text-anchor="middle">ChipWatcher调试模块</text>
  
  <!-- 时序监控点 -->
  <rect x="640" y="390" width="200" height="40" rx="5" fill="#ffdddd" stroke="#000000" stroke-width="1"/>
  <text x="740" y="415" font-family="Arial" font-size="12" text-anchor="middle">关键路径监控: G_d[2]_reg、skin_h_min_reg等</text>
  
  <!-- 连接线 -->
  <!-- TD到配置数据流 -->
  <line x1="300" y1="190" x2="350" y2="190" stroke="#000000" stroke-width="1" marker-end="url(#arrowhead)"/>
  <line x1="300" y1="260" x2="350" y2="260" stroke="#000000" stroke-width="1" marker-end="url(#arrowhead)"/>
  <line x1="300" y1="340" x2="350" y2="340" stroke="#000000" stroke-width="1" marker-end="url(#arrowhead)"/>
  <line x1="300" y1="420" x2="350" y2="420" stroke="#000000" stroke-width="1" marker-end="url(#arrowhead)"/>
  
  <!-- 配置数据流到FPGA -->
  <line x1="550" y1="190" x2="600" y2="190" stroke="#000000" stroke-width="1" marker-end="url(#arrowhead)"/>
  <line x1="550" y1="260" x2="600" y2="260" stroke="#000000" stroke-width="1" marker-end="url(#arrowhead)"/>
  <line x1="550" y1="340" x2="600" y2="340" stroke="#000000" stroke-width="1" marker-end="url(#arrowhead)"/>
  <line x1="550" y1="420" x2="600" y2="420" stroke="#000000" stroke-width="1" marker-end="url(#arrowhead)"/>
  
  <!-- 配置流程说明 -->
  <text x="500" y="540" font-family="Arial" font-size="14" font-weight="bold" text-anchor="middle">配置流程：TD环境 → 配置文件/位流生成 → FPGA加载与执行</text>
  <line x1="300" y1="550" x2="700" y2="550" stroke="#000000" stroke-width="2" marker-end="url(#arrowhead)"/>
  
  <!-- 配置特点 -->
  <text x="100" y="570" font-family="Arial" font-size="12" text-anchor="start">• 纯硬件配置：无需运行时软件支持</text>
  <text x="100" y="590" font-family="Arial" font-size="12" text-anchor="start">• 实时监控：通过ChipWatcher监控关键信号</text>
  
  <text x="500" y="570" font-family="Arial" font-size="12" text-anchor="start">• 时序优化：直接针对G_d[2]_reg等关键路径进行优化</text>
  <text x="500" y="590" font-family="Arial" font-size="12" text-anchor="start">• 配置持久：位流文件烧录后保持配置</text>
</svg>